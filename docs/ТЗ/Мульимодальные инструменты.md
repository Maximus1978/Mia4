# Мульимодальные инструменты

Единый интерфейс для действий вне текстового ответа (голос, просмотр файлов, простой web‑fetch). Позднее – vision.

## Цели
Стандартизовать подключение инструментов без связывания их с AgentLoop логикой.

## Категории
| Категория | Примеры | Синхронность | Ограничения |
|-----------|---------|--------------|-------------|
| audio_out | TTS (Piper) | async job | Макс длина текста |
| audio_in | STT (whisper) | stream | VAD контролирует stop |
| file_read | Чтение локальных заметок | sync | Sandbox path whitelist |
| web_search | DuckDuckGo API (будущее) | async | Rate limit |
| vision (позже) | Image describe | async | GPU VRAM |

## Интерфейс (черновик)
manifest.yaml (пример):
```yaml
name: audio_out
version: 0.1.0
capabilities: [tts]
config:
	voice: piper/ru
events:
	subscribe: [ MessageProcessed ]
	publish: [ AudioTaskQueued, AudioTaskCompleted ]
rate_limits:
	tasks_per_minute: 6
```

ITool:
```python
class ITool(Protocol):
		id: str
		def handles(event: Event) -> bool: ...
		async def process(event: Event) -> list[Event]: ...
```

## События
| Event | Payload | Описание |
|-------|---------|----------|
| AudioTaskQueued | {id, text} | Добавлено задание TTS |
| AudioTaskCompleted | {id, path} | Локальный путь к wav |
| STTStreamStarted | {session_id} | Начало сессии распознавания |
| STTStreamFinal | {session_id, text} | Финальный текст |

## Безопасность
Sandbox: все file_* инструменты ограничены корнем workspace/sandbox.
Network: внешние запросы только в списке разрешённых доменов.

## Ограничения / Не цели
Не реализуем сложный планировщик tool chains.
Не поддерживаем длительные фоновые агенты – только реактивные задачи.

## Будущее
Vision tool (скриншоты + описания).
Простой tool marketplace (внутренний каталог manifest.yaml).
